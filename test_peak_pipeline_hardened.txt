2025-05-12 22:00:49,906 - INFO - 
=== Running Test: Variant - Two clearly separated peaks 1 ===
2025-05-12 22:00:49,906 - INFO - Input peak parameters: [{'rt_center': 10.8, 'mz_center': 150.8, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 21000}, {'rt_center': 14.2, 'mz_center': 158.2, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 24000}]
2025-05-12 22:00:49,906 - INFO - Expected: 2 suspicious boxes, 0 overlaps, None peaks in overlaps
2025-05-12 22:00:49,961 - INFO - Suspicious boxes detected: 2
2025-05-12 22:00:49,961 - INFO - PASSED: Box test passed.
2025-05-12 22:00:54,431 - INFO - 
--- Region 1 ---
2025-05-12 22:00:54,431 - INFO - GMM: Detected single peak → no overlap
2025-05-12 22:00:54,431 - INFO - 
--- Region 2 ---
2025-05-12 22:00:54,431 - INFO - GMM: Detected single peak → no overlap
2025-05-12 22:00:54,431 - INFO - 
[GMM] Detection Summary (aggregate):
2025-05-12 22:00:54,431 - INFO -   TP=0, FP=0, FN=0, TN=1
2025-05-12 22:00:54,431 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=1.00
2025-05-12 22:00:54,431 - INFO - PASSED: GMM overlap region count correct.
2025-05-12 22:00:54,431 - INFO - 
--- Region 1 ---
2025-05-12 22:00:54,431 - INFO - RidgeWalker: Detected single peak → no overlap
2025-05-12 22:00:54,431 - INFO - 
--- Region 2 ---
2025-05-12 22:00:54,431 - INFO - RidgeWalker: Detected single peak → no overlap
2025-05-12 22:00:54,431 - INFO - 
[RidgeWalker] Detection Summary (aggregate):
2025-05-12 22:00:54,431 - INFO -   TP=0, FP=0, FN=0, TN=1
2025-05-12 22:00:54,431 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=1.00
2025-05-12 22:00:54,431 - INFO - PASSED: RidgeWalker overlap region count correct.
2025-05-12 22:00:54,431 - INFO - 
--- Region 1 ---
2025-05-12 22:00:54,431 - INFO - Wavelet: Detected single peak → no overlap
2025-05-12 22:00:54,431 - INFO - 
--- Region 2 ---
2025-05-12 22:00:54,431 - INFO - Wavelet: Detected single peak → no overlap
2025-05-12 22:00:54,431 - INFO - 
[Wavelet] Detection Summary (aggregate):
2025-05-12 22:00:54,431 - INFO -   TP=0, FP=0, FN=0, TN=1
2025-05-12 22:00:54,431 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=1.00
2025-05-12 22:00:54,431 - INFO - PASSED: Wavelet overlap region count correct.
2025-05-12 22:00:54,431 - INFO - 

=== NEW TEST ===
2025-05-12 22:00:54,431 - INFO - 
=== Running Test: Variant - Two clearly separated peaks 2 ===
2025-05-12 22:00:54,431 - INFO - Input peak parameters: [{'rt_center': 11.1, 'mz_center': 151.2, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 19000}, {'rt_center': 13.9, 'mz_center': 157.9, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 25500}]
2025-05-12 22:00:54,431 - INFO - Expected: 2 suspicious boxes, 0 overlaps, None peaks in overlaps
2025-05-12 22:00:54,516 - INFO - Suspicious boxes detected: 2
2025-05-12 22:00:54,517 - INFO - PASSED: Box test passed.
2025-05-12 22:00:56,643 - INFO - 
--- Region 1 ---
2025-05-12 22:00:56,643 - INFO - GMM: Detected single peak → no overlap
2025-05-12 22:00:56,643 - INFO - 
--- Region 2 ---
2025-05-12 22:00:56,643 - INFO - GMM: Detected single peak → no overlap
2025-05-12 22:00:56,643 - INFO - 
[GMM] Detection Summary (aggregate):
2025-05-12 22:00:56,643 - INFO -   TP=0, FP=0, FN=0, TN=1
2025-05-12 22:00:56,643 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=1.00
2025-05-12 22:00:56,643 - INFO - PASSED: GMM overlap region count correct.
2025-05-12 22:00:56,643 - INFO - 
--- Region 1 ---
2025-05-12 22:00:56,643 - INFO - RidgeWalker: Detected single peak → no overlap
2025-05-12 22:00:56,643 - INFO - 
--- Region 2 ---
2025-05-12 22:00:56,643 - INFO - RidgeWalker: Detected single peak → no overlap
2025-05-12 22:00:56,643 - INFO - 
[RidgeWalker] Detection Summary (aggregate):
2025-05-12 22:00:56,643 - INFO -   TP=0, FP=0, FN=0, TN=1
2025-05-12 22:00:56,643 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=1.00
2025-05-12 22:00:56,643 - INFO - PASSED: RidgeWalker overlap region count correct.
2025-05-12 22:00:56,643 - INFO - 
--- Region 1 ---
2025-05-12 22:00:56,643 - INFO - Wavelet: Detected single peak → no overlap
2025-05-12 22:00:56,643 - INFO - 
--- Region 2 ---
2025-05-12 22:00:56,643 - INFO - Wavelet: Detected single peak → no overlap
2025-05-12 22:00:56,643 - INFO - 
[Wavelet] Detection Summary (aggregate):
2025-05-12 22:00:56,643 - INFO -   TP=0, FP=0, FN=0, TN=1
2025-05-12 22:00:56,643 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=1.00
2025-05-12 22:00:56,643 - INFO - PASSED: Wavelet overlap region count correct.
2025-05-12 22:00:56,643 - INFO - 

=== NEW TEST ===
2025-05-12 22:00:56,643 - INFO - 
=== Running Test: Variant - Two clearly separated peaks 3 ===
2025-05-12 22:00:56,643 - INFO - Input peak parameters: [{'rt_center': 10.9, 'mz_center': 150.9, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 20500}, {'rt_center': 14.1, 'mz_center': 158.1, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 25000}]
2025-05-12 22:00:56,643 - INFO - Expected: 2 suspicious boxes, 0 overlaps, None peaks in overlaps
2025-05-12 22:00:56,721 - INFO - Suspicious boxes detected: 2
2025-05-12 22:00:56,721 - INFO - PASSED: Box test passed.
2025-05-12 22:00:58,351 - INFO - 
--- Region 1 ---
2025-05-12 22:00:58,351 - INFO - GMM: Detected single peak → no overlap
2025-05-12 22:00:58,351 - INFO - 
--- Region 2 ---
2025-05-12 22:00:58,351 - INFO - GMM: Detected single peak → no overlap
2025-05-12 22:00:58,351 - INFO - 
[GMM] Detection Summary (aggregate):
2025-05-12 22:00:58,351 - INFO -   TP=0, FP=0, FN=0, TN=1
2025-05-12 22:00:58,351 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=1.00
2025-05-12 22:00:58,351 - INFO - PASSED: GMM overlap region count correct.
2025-05-12 22:00:58,351 - INFO - 
--- Region 1 ---
2025-05-12 22:00:58,351 - INFO - RidgeWalker: Detected single peak → no overlap
2025-05-12 22:00:58,351 - INFO - 
--- Region 2 ---
2025-05-12 22:00:58,351 - INFO - RidgeWalker: Detected single peak → no overlap
2025-05-12 22:00:58,351 - INFO - 
[RidgeWalker] Detection Summary (aggregate):
2025-05-12 22:00:58,351 - INFO -   TP=0, FP=0, FN=0, TN=1
2025-05-12 22:00:58,351 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=1.00
2025-05-12 22:00:58,351 - INFO - PASSED: RidgeWalker overlap region count correct.
2025-05-12 22:00:58,351 - INFO - 
--- Region 1 ---
2025-05-12 22:00:58,351 - INFO - Wavelet: Detected single peak → no overlap
2025-05-12 22:00:58,351 - INFO - 
--- Region 2 ---
2025-05-12 22:00:58,351 - INFO - Wavelet: Detected single peak → no overlap
2025-05-12 22:00:58,351 - INFO - 
[Wavelet] Detection Summary (aggregate):
2025-05-12 22:00:58,351 - INFO -   TP=0, FP=0, FN=0, TN=1
2025-05-12 22:00:58,351 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=1.00
2025-05-12 22:00:58,351 - INFO - PASSED: Wavelet overlap region count correct.
2025-05-12 22:00:58,351 - INFO - 

=== NEW TEST ===
2025-05-12 22:00:58,351 - INFO - 
=== Running Test: Variant - Two clearly separated peaks 4 ===
2025-05-12 22:00:58,351 - INFO - Input peak parameters: [{'rt_center': 11.3, 'mz_center': 151.5, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 20000}, {'rt_center': 13.7, 'mz_center': 157.5, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 24500}]
2025-05-12 22:00:58,351 - INFO - Expected: 2 suspicious boxes, 0 overlaps, None peaks in overlaps
2025-05-12 22:00:58,416 - INFO - Suspicious boxes detected: 2
2025-05-12 22:00:58,416 - INFO - PASSED: Box test passed.
2025-05-12 22:01:00,319 - INFO - 
--- Region 1 ---
2025-05-12 22:01:00,319 - INFO - GMM: Detected single peak → no overlap
2025-05-12 22:01:00,319 - INFO - 
--- Region 2 ---
2025-05-12 22:01:00,319 - INFO - GMM: Detected single peak → no overlap
2025-05-12 22:01:00,319 - INFO - 
[GMM] Detection Summary (aggregate):
2025-05-12 22:01:00,319 - INFO -   TP=0, FP=0, FN=0, TN=1
2025-05-12 22:01:00,319 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=1.00
2025-05-12 22:01:00,319 - INFO - PASSED: GMM overlap region count correct.
2025-05-12 22:01:00,319 - INFO - 
--- Region 1 ---
2025-05-12 22:01:00,319 - INFO - RidgeWalker: Detected single peak → no overlap
2025-05-12 22:01:00,319 - INFO - 
--- Region 2 ---
2025-05-12 22:01:00,319 - INFO - RidgeWalker: Detected single peak → no overlap
2025-05-12 22:01:00,319 - INFO - 
[RidgeWalker] Detection Summary (aggregate):
2025-05-12 22:01:00,319 - INFO -   TP=0, FP=0, FN=0, TN=1
2025-05-12 22:01:00,321 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=1.00
2025-05-12 22:01:00,321 - INFO - PASSED: RidgeWalker overlap region count correct.
2025-05-12 22:01:00,321 - INFO - 
--- Region 1 ---
2025-05-12 22:01:00,321 - INFO - Wavelet: Detected single peak → no overlap
2025-05-12 22:01:00,321 - INFO - 
--- Region 2 ---
2025-05-12 22:01:00,321 - INFO - Wavelet: Detected single peak → no overlap
2025-05-12 22:01:00,321 - INFO - 
[Wavelet] Detection Summary (aggregate):
2025-05-12 22:01:00,321 - INFO -   TP=0, FP=0, FN=0, TN=1
2025-05-12 22:01:00,321 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=1.00
2025-05-12 22:01:00,321 - INFO - PASSED: Wavelet overlap region count correct.
2025-05-12 22:01:00,321 - INFO - 

=== NEW TEST ===
2025-05-12 22:01:00,321 - INFO - 
=== Running Test: Variant - Two clearly separated peaks 5 ===
2025-05-12 22:01:00,321 - INFO - Input peak parameters: [{'rt_center': 10.7, 'mz_center': 150.5, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 19500}, {'rt_center': 14.3, 'mz_center': 158.3, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 24800}]
2025-05-12 22:01:00,321 - INFO - Expected: 2 suspicious boxes, 0 overlaps, None peaks in overlaps
2025-05-12 22:01:00,391 - INFO - Suspicious boxes detected: 2
2025-05-12 22:01:00,391 - INFO - PASSED: Box test passed.
2025-05-12 22:01:02,257 - INFO - 
--- Region 1 ---
2025-05-12 22:01:02,257 - INFO - GMM: Detected single peak → no overlap
2025-05-12 22:01:02,257 - INFO - 
--- Region 2 ---
2025-05-12 22:01:02,257 - INFO - GMM: Detected single peak → no overlap
2025-05-12 22:01:02,257 - INFO - 
[GMM] Detection Summary (aggregate):
2025-05-12 22:01:02,257 - INFO -   TP=0, FP=0, FN=0, TN=1
2025-05-12 22:01:02,257 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=1.00
2025-05-12 22:01:02,257 - INFO - PASSED: GMM overlap region count correct.
2025-05-12 22:01:02,257 - INFO - 
--- Region 1 ---
2025-05-12 22:01:02,257 - INFO - RidgeWalker: Detected single peak → no overlap
2025-05-12 22:01:02,257 - INFO - 
--- Region 2 ---
2025-05-12 22:01:02,257 - INFO - RidgeWalker: Detected single peak → no overlap
2025-05-12 22:01:02,257 - INFO - 
[RidgeWalker] Detection Summary (aggregate):
2025-05-12 22:01:02,257 - INFO -   TP=0, FP=0, FN=0, TN=1
2025-05-12 22:01:02,257 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=1.00
2025-05-12 22:01:02,257 - INFO - PASSED: RidgeWalker overlap region count correct.
2025-05-12 22:01:02,257 - INFO - 
--- Region 1 ---
2025-05-12 22:01:02,257 - INFO - Wavelet: Detected single peak → no overlap
2025-05-12 22:01:02,257 - INFO - 
--- Region 2 ---
2025-05-12 22:01:02,257 - INFO - Wavelet: Detected single peak → no overlap
2025-05-12 22:01:02,257 - INFO - 
[Wavelet] Detection Summary (aggregate):
2025-05-12 22:01:02,257 - INFO -   TP=0, FP=0, FN=0, TN=1
2025-05-12 22:01:02,257 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=1.00
2025-05-12 22:01:02,257 - INFO - PASSED: Wavelet overlap region count correct.
2025-05-12 22:01:02,261 - INFO - 

=== NEW TEST ===
2025-05-12 22:01:02,261 - INFO - 
=== Running Test: Variant - Strong overlap between two peaks 1 ===
2025-05-12 22:01:02,261 - INFO - Input peak parameters: [{'rt_center': 13.0, 'mz_center': 154.4, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 17000}, {'rt_center': 13.05, 'mz_center': 154.5, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 46000}]
2025-05-12 22:01:02,261 - INFO - Expected: 1 suspicious boxes, 1 overlaps, 2 peaks in overlaps
2025-05-12 22:01:02,314 - INFO - Suspicious boxes detected: 1
2025-05-12 22:01:02,314 - INFO - PASSED: Box test passed.
2025-05-12 22:01:19,483 - INFO - 
--- Region 1 ---
2025-05-12 22:01:19,483 - INFO - GMM: Detected single peak → no overlap
2025-05-12 22:01:19,483 - INFO - 
[GMM] Detection Summary (aggregate):
2025-05-12 22:01:19,483 - INFO -   TP=0, FP=0, FN=1, TN=0
2025-05-12 22:01:19,483 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=0.00
2025-05-12 22:01:19,483 - ERROR - FAILED: GMM overlap region count mismatch - expected 1, got 0
2025-05-12 22:01:19,483 - ERROR - FAILED: GMM peak count in overlaps mismatch - expected 2, got 0
2025-05-12 22:01:19,483 - INFO - 
--- Region 1 ---
2025-05-12 22:01:19,483 - INFO - RidgeWalker: Detected 2 peaks (ΔBIC=0.00, support=N/A) → overlap confirmed
2025-05-12 22:01:19,483 - INFO - 
[RidgeWalker] Detection Summary (aggregate):
2025-05-12 22:01:19,483 - INFO -   TP=1, FP=0, FN=0, TN=0
2025-05-12 22:01:19,483 - INFO -   Precision=1.00, Recall=1.00, F1=1.00, Accuracy=1.00
2025-05-12 22:01:19,483 - INFO - PASSED: RidgeWalker overlap region count correct.
2025-05-12 22:01:19,483 - INFO - PASSED: RidgeWalker peak count in overlaps correct.
2025-05-12 22:01:19,483 - INFO - 
--- Region 1 ---
2025-05-12 22:01:19,483 - INFO - Wavelet: Detected single peak → no overlap
2025-05-12 22:01:19,483 - INFO - 
[Wavelet] Detection Summary (aggregate):
2025-05-12 22:01:19,483 - INFO -   TP=0, FP=0, FN=1, TN=0
2025-05-12 22:01:19,486 - INFO -   Precision=0.00, Recall=0.00, F1=0.00, Accuracy=0.00
2025-05-12 22:01:19,486 - ERROR - FAILED: Wavelet overlap region count mismatch - expected 1, got 0
2025-05-12 22:01:19,486 - ERROR - FAILED: Wavelet peak count in overlaps mismatch - expected 2, got 0
2025-05-12 22:01:19,487 - INFO - 

=== NEW TEST ===
2025-05-12 22:01:19,487 - INFO - 
=== Running Test: Variant - Strong overlap between two peaks 2 ===
2025-05-12 22:01:19,487 - INFO - Input peak parameters: [{'rt_center': 13.2, 'mz_center': 154.6, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 19000}, {'rt_center': 13.3, 'mz_center': 154.5, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 44000}]
2025-05-12 22:01:19,487 - INFO - Expected: 1 suspicious boxes, 1 overlaps, 2 peaks in overlaps
2025-05-12 22:01:19,635 - INFO - Suspicious boxes detected: 1
2025-05-12 22:01:19,635 - INFO - PASSED: Box test passed.
2025-05-12 22:01:22,710 - INFO - 
--- Region 1 ---
2025-05-12 22:01:22,710 - INFO - GMM: Detected 2 peaks (ΔBIC=0.00, support=N/A) → overlap confirmed
2025-05-12 22:01:22,710 - INFO - 
[GMM] Detection Summary (aggregate):
2025-05-12 22:01:22,710 - INFO -   TP=1, FP=0, FN=0, TN=0
2025-05-12 22:01:22,710 - INFO -   Precision=1.00, Recall=1.00, F1=1.00, Accuracy=1.00
2025-05-12 22:01:22,710 - INFO - PASSED: GMM overlap region count correct.
2025-05-12 22:01:22,710 - INFO - PASSED: GMM peak count in overlaps correct.
2025-05-12 22:01:22,710 - INFO - 
--- Region 1 ---
2025-05-12 22:01:22,710 - INFO - RidgeWalker: Detected 2 peaks (ΔBIC=0.00, support=N/A) → overlap confirmed
2025-05-12 22:01:22,710 - INFO - 
[RidgeWalker] Detection Summary (aggregate):
2025-05-12 22:01:22,710 - INFO -   TP=1, FP=0, FN=0, TN=0
2025-05-12 22:01:22,710 - INFO -   Precision=1.00, Recall=1.00, F1=1.00, Accuracy=1.00
2025-05-12 22:01:22,710 - INFO - PASSED: RidgeWalker overlap region count correct.
2025-05-12 22:01:22,710 - INFO - PASSED: RidgeWalker peak count in overlaps correct.
2025-05-12 22:01:22,710 - INFO - 
--- Region 1 ---
2025-05-12 22:01:22,710 - INFO - Wavelet: Detected 2 peaks (ΔBIC=0.00, support=N/A) → overlap confirmed
2025-05-12 22:01:22,710 - INFO - 
[Wavelet] Detection Summary (aggregate):
2025-05-12 22:01:22,710 - INFO -   TP=1, FP=0, FN=0, TN=0
2025-05-12 22:01:22,710 - INFO -   Precision=1.00, Recall=1.00, F1=1.00, Accuracy=1.00
2025-05-12 22:01:22,710 - INFO - PASSED: Wavelet overlap region count correct.
2025-05-12 22:01:22,710 - INFO - PASSED: Wavelet peak count in overlaps correct.
2025-05-12 22:01:22,713 - INFO - 

=== NEW TEST ===
2025-05-12 22:01:22,713 - INFO - 
=== Running Test: Variant - Strong overlap between two peaks 3 ===
2025-05-12 22:01:22,713 - INFO - Input peak parameters: [{'rt_center': 12.9, 'mz_center': 154.3, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 18000}, {'rt_center': 13.0, 'mz_center': 154.2, 'rt_sigma': 0.2, 'mz_sigma': 0.04, 'amplitude': 46000}]
2025-05-12 22:01:22,713 - INFO - Expected: 1 suspicious boxes, 1 overlaps, 2 peaks in overlaps
2025-05-12 22:01:22,771 - INFO - Suspicious boxes detected: 1
2025-05-12 22:01:22,771 - INFO - PASSED: Box test passed.
